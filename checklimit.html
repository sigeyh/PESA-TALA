<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PESA TALA - Loan Limit</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-purple-900 via-purple-800 to-gray-200 text-white min-h-screen flex items-center justify-center px-4">

  <div class="bg-white/10 backdrop-blur-lg p-6 rounded-2xl shadow-2xl max-w-sm w-full text-center border border-purple-300">
    <h2 class="text-xl font-bold mb-2">ðŸŽ‰ Loan Limit Approved</h2>
    <p class="text-sm text-gray-200 mb-4">Adjust your loan amount below</p>

    <!-- Display Loan Amount -->
    <div class="text-4xl font-bold text-yellow-400 mb-2" id="loanAmount">Ksh 0</div>

    <!-- Range Slider -->
    <input type="range" id="loanSlider" min="1800" max="5000" step="100"
      class="w-full accent-yellow-400 bg-gray-100 rounded-lg h-2 mb-2" />

    <!-- Progress Bar -->
    <div class="w-full bg-gray-300 rounded-full h-3 overflow-hidden mb-3">
      <div id="progressBar" class="bg-yellow-400 h-3 transition-all duration-300"></div>
    </div>

    <!-- Fee Display -->
    <p class="text-sm text-gray-200 mb-1">
      Processing Fee (5.5%): <span class="text-yellow-300 font-semibold" id="processingFee">Ksh 0</span>
    </p>

    <!-- Proceed Button -->
    <button onclick="showPopup()" class="mt-4 w-full bg-yellow-400 hover:bg-yellow-300 text-purple-900 font-bold py-2 rounded-xl shadow transition">
      Proceed
    </button>
  </div>

  <!-- Pop-up Modal -->
  <div id="popup" class="fixed inset-0 bg-black/70 flex items-center justify-center hidden z-50">
    <div class="bg-white text-purple-900 p-6 rounded-xl shadow-2xl max-w-sm w-full text-center">
      <h2 class="text-xl font-bold mb-2">ðŸŽŠ Congratulations!</h2>
      <p class="mb-2">You qualify for a loan of:</p>
      <div class="text-3xl font-bold text-purple-700" id="finalLoan">Ksh 0</div>
      <p class="mt-4 text-sm text-gray-600">Repayment Period: <strong>14 days</strong></p>
      <p class="text-sm text-gray-600">Processing Fee: <span id="popupFee" class="font-semibold text-purple-700">Ksh 0</span></p>
      <p class="text-sm text-gray-600">Total Repayable: <span id="totalRepay" class="font-semibold text-purple-700">Ksh 0</span></p>

      <button onclick="continueToNext()" class="mt-5 bg-purple-700 hover:bg-purple-800 text-white py-2 px-6 rounded-xl shadow">
        Continue
      </button>
    </div>
  </div>

  <script>
    const minLoan = 1800;
    const maxLoan = 5000;
    const slider = document.getElementById("loanSlider");
    const loanDisplay = document.getElementById("loanAmount");
    const feeDisplay = document.getElementById("processingFee");
    const progressBar = document.getElementById("progressBar");

    const popup = document.getElementById("popup");
    const finalLoan = document.getElementById("finalLoan");
    const popupFee = document.getElementById("popupFee");
    const totalRepay = document.getElementById("totalRepay");

    // Generate random loan
    const randomLoan = Math.floor(Math.random() * (maxLoan - minLoan + 1)) + minLoan;
    slider.value = randomLoan;

    function updateUI(loan) {
      loanDisplay.textContent = "Ksh " + loan.toLocaleString();
      const fee = Math.round(loan * 0.055);
      feeDisplay.textContent = "Ksh " + fee;

      const progress = ((loan - minLoan) / (maxLoan - minLoan)) * 100;
      progressBar.style.width = progress + "%";

      // Store for popup
      finalLoan.textContent = "Ksh " + loan.toLocaleString();
      popupFee.textContent = "Ksh " + fee;
      totalRepay.textContent = "Ksh " + (loan + fee).toLocaleString();

      localStorage.setItem("loanAmount", loan);
      localStorage.setItem("processingFee", fee);
    }

    // Initial render
    updateUI(randomLoan);

    slider.addEventListener("input", () => {
      const loan = parseInt(slider.value);
      updateUI(loan);
    });

    function showPopup() {
      popup.classList.remove("hidden");
    }

    function continueToNext() {
      popup.classList.add("hidden");
      // Replace with actual page redirect if needed
      alert("You can now proceed to payment or next step.");
      // Example: window.location.href = "verification.html";
    }
  </script>

</body>
</html>
